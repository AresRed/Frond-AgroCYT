<div class="p-6 pt-0">
    <p-toast></p-toast> <!-- Componente Toast de PrimeNG -->
    <p-card header="Carga y Envío de Documentos al Empleado" styleClass="shadow-2xl">
        <p class="mb-6 text-gray-600">Suba una boleta de pago o un certificado y asócielo al perfil del trabajador.</p>

        <form (ngSubmit)="uploadDocument()" class="space-y-6"> 
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Seleccionar Empleado (Destino)</label>
                    <p-dropdown 
                        [options]="employees" 
                        [(ngModel)]="selectedEmployeeId" 
                        optionLabel="fullName" 
                        optionValue="id" 
                        placeholder="-- Seleccione Trabajador --" 
                        name="employeeId" 
                        required
                        [ngClass]="{'ng-invalid ng-dirty': submitted && !selectedEmployeeId}"
                        styleClass="w-full">
                         <ng-template let-emp pTemplate="item">
                            <div>{{ emp.fullName }} ({{ emp.employeeCode }})</div>
                        </ng-template>
                    </p-dropdown>
                    <small class="p-error" *ngIf="submitted && !selectedEmployeeId">Empleado es requerido.</small>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Tipo de Documento</label>
                    <input pInputText type="text" [(ngModel)]="documentType" name="documentType" required
                           placeholder="Ej: Boleta de Pago Noviembre" 
                           class="w-full p-2 border rounded-md"
                           [ngClass]="{'ng-invalid ng-dirty': submitted && !documentType}">
                    <small class="p-error" *ngIf="submitted && !documentType">Tipo de documento es requerido.</small>
                </div>
            </div>

            <div class="border p-4 rounded-lg bg-gray-50">
                <p-fileupload 
                    #fileUpload 
                    mode="basic" 
                    name="file" (onSelect)="onFileSelect($event)" 
                    [auto]="false" 
                    [customUpload]="true"
                    [chooseLabel]="selectedFile ? selectedFile.name : 'Seleccionar Archivo'"
                    [multiple]="false" 
                    accept=".pdf,.docx,.xlsx" 
                    maxFileSize="1000000">
                </p-fileupload>
                <p class="text-xs text-gray-500 mt-2">Formatos aceptados: PDF, DOCX, XLSX. Máx. 1MB.</p>
                <small class="p-error" *ngIf="submitted && !selectedFile">Archivo es requerido.</small>
            </div>

            <div class="pt-4">
                <p-button type="submit" [label]="isLoading ? 'Subiendo...' : 'Subir y Asociar Documento'" 
                          icon="pi pi-upload" 
                          [loading]="isLoading"
                          [disabled]="isLoading"
                          styleClass="p-button-success w-full shadow-md">
                </p-button>
            </div>
        </form>
    </p-card>
</div>
